import { test } from '../index.ts';

Deno.test('should validate IP addresses', () => {
  test({
    validator: 'isIP',
    valid: [
      '127.0.0.1',
      '0.0.0.0',
      '255.255.255.255',
      '1.2.3.4',
      '::1',
      '2001:db8:0000:1:1:1:1:1',
      '2001:41d0:2:a141::1',
      '::ffff:127.0.0.1',
      '::0000',
      '0000::',
      '1::',
      '1111:1:1:1:1:1:1:1',
      'fe80::a6db:30ff:fe98:e946',
      '::',
      '::ffff:127.0.0.1',
      '0:0:0:0:0:ffff:127.0.0.1',
    ],
    invalid: [
      'abc',
      '256.0.0.0',
      '0.0.0.256',
      '26.0.0.256',
      '0200.200.200.200',
      '200.0200.200.200',
      '200.200.0200.200',
      '200.200.200.0200',
      '::banana',
      'banana::',
      '::1banana',
      '::1::',
      '1:',
      ':1',
      ':1:1:1::2',
      '1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1',
      '::11111',
      '11111:1:1:1:1:1:1:1',
      '2001:db8:0000:1:1:1:1::1',
      '0:0:0:0:0:0:ffff:127.0.0.1',
      '0:0:0:0:ffff:127.0.0.1',
    ],
  });
});

Deno.test('should validate IPv4 addresses', () => {
  test({
    validator: 'isIP',
    args: [4],
    valid: [
      '127.0.0.1',
      '0.0.0.0',
      '255.255.255.255',
      '1.2.3.4',
      '255.0.0.1',
      '0.0.1.1',
    ],
    invalid: [
      '::1',
      '2001:db8:0000:1:1:1:1:1',
      '::ffff:127.0.0.1',
      '137.132.10.01',
      '0.256.0.256',
      '255.256.255.256',
    ],
  });
});

Deno.test('should validate IPv6 addresses', () => {
  test({
    validator: 'isIP',
    args: [6],
    valid: [
      '::1',
      '2001:db8:0000:1:1:1:1:1',
      '::ffff:127.0.0.1',
      'fe80::1234%1',
      'ff08::9abc%10',
      'ff08::9abc%interface10',
      'ff02::5678%pvc1.3',
    ],
    invalid: [
      '127.0.0.1',
      '0.0.0.0',
      '255.255.255.255',
      '1.2.3.4',
      '::ffff:287.0.0.1',
      '%',
      'fe80::1234%',
      'fe80::1234%1%3%4',
      'fe80%fe80%',
    ],
  });
});

Deno.test('should not validate not existing IPv10 addresses', () => {
  test({
    validator: 'isIP',
    args: [10],
    valid: [],
    invalid: [
      '127.0.0.1',
      '0.0.0.0',
      '255.255.255.255',
      '1.2.3.4',
      '::1',
      '2001:db8:0000:1:1:1:1:1',
    ],
  });
});
